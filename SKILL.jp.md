---
name: open-reflect
description: |
  知識の進化を追跡する高度な自己学習・振り返りシステム。
  修正、成功パターン、偏好、ベストプラクティスを捉え、それらを完全な進化履歴とともに REFLECT.md に整理します。
  Claude Code（フルプラグイン）と OpenCode（基本スキル）の両方をサポートします。
  学習、修正について議論時や、ユーザーが記憶について言及した際に使用。
  トリガー: "これを覚えて", "Xを使ってYは使わないで", "実は...", "完美！", 修正, フィードバック。
allowed-tools: Read, Write, Edit, Glob, Bash(jq:*), Bash(cat:*), AskUserQuestion, Grep
version: 1.1.0
license: MIT
author: OpenReflect Team
compatibility: claude-code,opencode
---

# Open-Reflect - 高度な自己学習・振り返りシステム

**デュアルプラットフォーム対応**: Claude Code（フルプラグイン） + OpenCode（基本スキル）

AI アシスタントがすべての対話から学び、振り返り、进化する3段階システム。

## プラットフォームサポート

### Claude Code（フルプラグイン）
- 場所: `~/.claude/plugins/open-reflect/`
- 機能: 自動キャプチャ、hooks、キュー管理、進化追跡
- コマンド: `/reflect`, `/reflect --view`, `/reflect --analyze`, `/skip-reflect`

### OpenCode（基本スキル）
- 場所: `.opencode/skill/open-reflect/SKILL.md` または `~/.config/opencode/skill/open-reflect/`
- 機能: スキルロード、指示リファレンス、手動操作
- 使用法: `skill({ name: "open-reflect" })`

詳細は [docs/OPENCODE_COMPATIBILITY.jp.md](docs/OPENCODE_COMPATIBILITY.jp.md) を参照。

## 動作原理

**ステージ 1: キャッチ（Claude Code では自動、OpenCode では手動）**
拡張 hooks が複数の学習次元を検出し、`~/.claude/openreflect-queue.json` にキューします：

| 学習タイプ | トリガー | 信頼度 | 例 |
|------------|----------|--------|------|
| **明示的マーク** | "remember:" | 0.95（最高） | "remember: Python に venv を使用" |
| **修正** | "no, use X", "don't use Y" | 0.90 | "no, gpt-5 ではなく gpt-5.1 を使用" |
| **成功パターン** | "Perfect!", "Great approach" | 0.75 | "Perfect! これが wanted だった" |
| **偏好** | "you should use", "I prefer" | 0.70 | "私は短い関数を好む" |

各キャプチャされた学習には以下が含まれます：
- 多次元分類（修正/成功/偏好/ベストプラクティス）
- 優先度レベル（重要/高/中/通常）
- 信頼度スコア（0.60-0.95）
- セマンティックタグ
- 進化追跡（最適化回数、使用回数、最終検証）

**ステージ 2: 振り返り（手動）**
ユーザーは `/reflect` を実行して、キュー内の学習をレビューし、REFLECT.md に適用します：
- 多次元分類
- 重複/競合検出
- 進化履歴追跡
- スマート重複除去と統合
- 優先度ベースの処理

**ステージ 3: 進化（継続）**
REFLECT.md は知識進化記録として機能：
- 学習履歴と変更を追跡
- 使用状況と検証を監視
- パターンと傾向を特定
- 改善のための実行可能な洞察を提供

## 利用可能なコマンド

| コマンド | 目的 |
|----------|------|
| `/reflect` | レビューとともにキュー内の学習を処理 |
| `/reflect --analyze` | REFLECT.md の進化を分析して洞察を提供 |
| `/reflect --view` | 詳細なメタデータとともにキューを表示 |
| `/reflect --critical-only` | 重要な優先度のみを処理 |
| `/reflect --scan-history` | 過去のセッションで遗漏した学習をスキャン |
| `/skip-reflect` | すべてのキュー学習を破棄 |

## ユーザーにいつ思い出させるか

以下の場合にユーザーに `/reflect` を思い出させます：
- 機能や意味のある作業単位を完了したとき
- 覚えるべき修正を行ったとき
- 「これを覚えて」や類似のことを明示的に言ったとき
- コンテキストが圧縮されようとしており、キューに重要な項目があるとき
- 保留中の学習がある状態で Git コミットが検出されたとき
- 成功パターンがキャプチャされたとき（ポジティブなフィードバック）

## 拡張された学習分類

| 分類 | 説明 | 例 |
|------|------|------|
| **修正** | 錯誤とその修正方法 | "no, X を使って Y は使わないで" |
| **成功パターン** | うまくいったこと（ポジティブなフィードバック） | "Perfect! 正しい" |
| **偏好** | ユーザーの偏好とスタイルの選択 | "私は明示的な型を好む" |
| **ベストプラクティス** | 発見されたベストプラクティス | "常に 入力を検証" |
| **一般的なエラー** | 避けるべきエラー | "エラー処理を忘れないで" |

## REFLECT.md 構造

REFLECT.md はコア知識進化ファイルです。详见 [README.jp.md](README.jp.md)。

## claude-reflect との拡張比較

| 機能 | claude-reflect | open-reflect |
|------|---------------|--------------|
| **プラットフォームサポート** | Claude Code のみ | Claude Code + OpenCode |
| **学習タイプ** | 修正のみ | 修正 + 成功 + 偏好 + ベストプラクティス |
| **データ構造** | シンプルなキュー | 進化を伴う構造化 REFLECT.md |
| **進化追跡** | なし | 完全な履歴（最適化、使用、検証） |
| **優先度レベル** | 信頼度のみ | 優先度 + 信頼度 + タグ |
| **重複処理** | 基本的 | セマンティック + 競合検出 + 統合 |
| **分析** | 基本的なキュービュー | 傾向分析 + 洞察 + 提案 |
| **マルチターゲット** | CLAUDE.md + AGENTS.md | REFLECT.md + CLAUDE.md + AGENTS.md |

## 哲学

Open-Reflect は原則を体現しています：**"振り返りを通じて学び、実践を通じて进化する"**

単純なキャプチャシステムとは異なり、Open-Reflect：
1. **幅広くキャプチャ**: 错误だけでなく、成功、偏好、パターンも
2. **深く振り返る**: 完全な進化履歴とコンテキストを維持
3. **継続的に进化**: 使用、検証、最適化を追跡
4. **インテリジェントに分析**: 傾向、競合、最適化の洞察を提供

システムは自動化しつつも人間の自律性を尊重します：
- 🤖 自動キャプチャ（機械効率）
- 👤 手動レビュー（人間の判断）
- 📈 継続的进化（反復的改善）
